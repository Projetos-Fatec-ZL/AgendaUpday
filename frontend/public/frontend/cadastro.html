<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AgendaUpday - Cadastro</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

  <main class="container">
       
        <!-- Lado esquerdo -->
        <section class="left">
           
            <button class="carousel-arrow left-arrow" id="prevSlide">
                &#10094; </button>
           
            <div class="carousel-slides" id="carouselSlides">
               
                <div class="carousel-slide-content">
                    <h1>Organize sua vida de <span>estudante</span></h1>
                    <p>
                        Planeje provas, organize hor√°rios de estudo, cuide do seu bem-estar e conquiste seus objetivos acad√™micos com a <strong>AgendaUpday</strong>.
                    </p>
           
                    <div class="features">
                        <div class="feature">
                            <h3>üìò Agenda Inteligente</h3>
                            <p>Gerencie provas, trabalhos e estudos</p>
                        </div>
                        <div class="feature">
                            <h3>üóìÔ∏è Planejamento</h3>
                            <p>Organize seus hor√°rios de estudo</p>
                        </div>
                        <div class="feature">
                            <h3>üíÜ‚Äç‚ôÄÔ∏è Bem-estar</h3>
                            <p>Controle sono e exerc√≠cios</p>
                        </div>
                        <div class="feature">
                            <h3>üîî Lembretes</h3>
                            <p>Notifica√ß√µes por e-mail e web</p>
                        </div>
                    </div>
                </div>
               
                <div class="carousel-slide-content generic-bg-1">
                     </div>
               
                <div class="carousel-slide-content generic-bg-2">
                    </div>
 
            </div>
           
            <button class="carousel-arrow right-arrow" id="nextSlide">
                &#10095; </button>
           
            <div class="carousel-dots" id="carouselDots">
                <span class="dot active" data-slide="0"></span>
                <span class="dot" data-slide="1"></span>
                <span class="dot" data-slide="2"></span>
            </div>
           
        </section>
 
        <!-- Lado direito -->
        <section class="right">
            <h2>Criar Conta</h2>
            <p>Comece a organizar seus estudos</p>
 
            <form id="cadastroForm">
                <label for="nome">Nome</label>
                <input type="text" id="nome" placeholder="Seu nome" required>
 
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="Digite seu email.." required>
 
                <label for="senha">Senha</label>
                <input type="password" id="senha" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>

                <a href="#" class="forgot-password-link" id="forgotPasswordLink">Esqueci minha senha</a>
 
                <button type="submit">Criar Conta</button>
 
                <p class="login-text">J√° tem conta? <a href="login.html">Entre</a></p>
            </form>
 
            <p id="mensagem"></p>
        </section>
 
<div class="modal-overlay" id="emailModal">
    <div class="modal-content">
        <section class="email-box"> 
            
            <button class="close-button" onclick="closeEmailModal()">
                &times; 
            </button>
            
            <h2>Esqueceu sua Senha?</h2>
            <p>Digite o e-mail associado √† sua conta. Enviaremos um c√≥digo de recupera√ß√£o para voc√™.</p>

            <form id="emailForm">
                <label for="recoveryEmail">Seu E-mail</label>
                <input 
                    type="email" 
                    id="recoveryEmail" 
                    placeholder="exemplo@email.com" 
                    required 
                >

                <button type="submit">Enviar C√≥digo</button>

                <p id="email-modal-message" class="login-text" style="margin-top: 15px; color: red;"></p>
            </form>
        </section>
    </div>
</div>

        <div class="modal-overlay" id="recoveryModal">
    <div class="modal-content">
        <section class="recovery-box"> 
            
            <button class="close-button" onclick="closeRecoveryModal()">
                &times; </button>
            
            <h2>Recupera√ß√£o de Senha</h2>
            <p>Um c√≥digo de recupera√ß√£o foi enviado para o seu email. Digite-o abaixo para continuar.</p>

            <form id="recoveryForm">
                <label for="recoveryCode">C√≥digo de Recupera√ß√£o</label>
                <input 
                    type="text" 
                    id="recoveryCode" 
                    placeholder="Ex: 123456" 
                    required 
                    maxlength="6"
                >

                <label for="newPassword">Nova Senha</label>
                <input 
                    type="password" 
                    id="newPassword" 
                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                    required
                    disabled
                >

                <label for="confirmPassword">Confirmar Senha</label>
                <input 
                    type="password" 
                    id="confirmPassword" 
                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                    required
                    disabled
                >

                <button type="submit" id="validateButton">Validar C√≥digo</button>
                <button type="button" id="resetButton" style="display: none;">Redefinir Senha</button>

                <p id="modal-message" class="login-text" style="margin-top: 15px; color: red;"></p>
            </form>
        </section>
    </div>
</div>
    </main>
   
    <script>
    // --- 1. VARI√ÅVEIS DO CARROSSEL ---
    const slidesContainer = document.getElementById('carouselSlides');
    const dotsContainer = document.getElementById('carouselDots');
    const dots = dotsContainer.querySelectorAll('.dot');
    const prevButton = document.getElementById('prevSlide');
    const nextButton = document.getElementById('nextSlide');
    
    // Total de slides agora √© 4
    const totalSlides = dots.length;
    let currentSlide = 0;

    // --- 2. VARI√ÅVEIS DOS MODAIS ---
    const forgotPasswordLink = document.getElementById('forgotPasswordLink');
    
    // VARI√ÅVEIS DO MODAL 1: E-MAIL
    const emailModal = document.getElementById('emailModal');
    const emailForm = document.getElementById('emailForm');
    const recoveryEmailInput = document.getElementById('recoveryEmail');
    const emailModalMessage = document.getElementById('email-modal-message');

    // VARI√ÅVEIS DO MODAL 2: C√ìDIGO E SENHA
    const recoveryModal = document.getElementById('recoveryModal');
    const recoveryForm = document.getElementById('recoveryForm');
    const validateButton = document.getElementById('validateButton');
    const resetButton = document.getElementById('resetButton');
    const newPasswordInput = document.getElementById('newPassword');
    const confirmPasswordInput = document.getElementById('confirmPassword');
    const recoveryCodeInput = document.getElementById('recoveryCode');
    const modalMessage = document.getElementById('modal-message');
    
    // Estado para controle de fluxo
    let codeValidated = false;
    let registeredEmail = ''; // Armazena o email enviado para o segundo modal

    // --- 3. FUN√á√ïES DO CARROSSEL ---
    
    function updateCarousel() { ¬†
        // Move os slides (o c√°lculo 100 / totalSlides √© 25%)
        slidesContainer.style.transform = `translateX(-${currentSlide * (100 / totalSlides)}%)`;
        
        // Atualiza a classe 'active' nos pontos
        dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentSlide);
        });
    }

    function goToSlide(index) {
        if (index < 0) {
            currentSlide = totalSlides - 1;
        } else if (index >= totalSlides) {
            currentSlide = 0;
        } else {
            currentSlide = index;
        }
        updateCarousel();
    }
    
    // --- 4. FUN√á√ïES DE CONTROLE DOS MODAIS ---

    // Abertura do primeiro modal (E-MAIL)
    function openEmailModal() {
        emailModal.style.display = 'flex';
        emailForm.reset();
        emailModalMessage.textContent = '';
    }
    
    // Fechamento do primeiro modal (chamada no onclick do 'X')
    function closeEmailModal() {
        emailModal.style.display = 'none';
    }

    // Abertura do segundo modal (C√ìDIGO E SENHA)
    function openRecoveryModal() {
        recoveryModal.style.display = 'flex';
        // Reseta o estado do segundo modal ao abrir
        codeValidated = false;
        newPasswordInput.disabled = true;
        confirmPasswordInput.disabled = true;
        recoveryCodeInput.disabled = false;
        validateButton.style.display = 'block';
        resetButton.style.display = 'none';
        modalMessage.textContent = '';
        recoveryForm.reset();
    }

    // Fechamento do segundo modal (chamada no onclick do 'X')
    function closeRecoveryModal() {
        recoveryModal.style.display = 'none';
    }


    // --- 5. EVENT LISTENERS ---

    document.addEventListener('DOMContentLoaded', () => {
        
        // 5.1. Listeners do Carrossel (Setas)
        prevButton.addEventListener('click', () => {
            goToSlide(currentSlide - 1);
        });

        nextButton.addEventListener('click', () => {
            goToSlide(currentSlide + 1);
        });

        // 5.2. Listener do Carrossel (Pontos de Navega√ß√£o)
        dotsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('dot')) {
                const slideIndex = parseInt(e.target.dataset.slide);
                goToSlide(slideIndex);
            }
        });

        // 5.3. Autoplay do Carrossel (Intervalo de 10 segundos)
        setInterval(() => {
            goToSlide(currentSlide + 1);
        }, 10000);

        // 5.4. Listener para abrir o PRIMEIRO Modal (Link "Esqueci minha senha")
        if (forgotPasswordLink) {
            forgotPasswordLink.addEventListener('click', (e) => {
                e.preventDefault(); 
                openEmailModal();
            });
        }
        
        // 5.5. L√≥gica do MODAL DE E-MAIL (Primeiro Passo)
        emailForm.addEventListener('submit', (e) => {
            e.preventDefault();
            emailModalMessage.textContent = '';

            registeredEmail = recoveryEmailInput.value;

            // SIMULA√á√ÉO DE VALIDA√á√ÉO DE E-MAIL
            if (registeredEmail && registeredEmail.includes('@')) {
                emailModalMessage.style.color = 'green';
                emailModalMessage.textContent = `C√≥digo enviado para ${registeredEmail}!`;
                
                // FLUXO PRINCIPAL: Fecha o primeiro e abre o segundo modal
                setTimeout(() => {
                    closeEmailModal();
                    openRecoveryModal();
                }, 1000); 

            } else {
                emailModalMessage.style.color = 'red';
                emailModalMessage.textContent = 'Por favor, insira um e-mail v√°lido.';
            }
        });
        
        // 5.6. L√≥gica do MODAL DE C√ìDIGO E SENHA (Segundo Passo)
        recoveryForm.addEventListener('submit', (e) => {
            e.preventDefault();
            modalMessage.textContent = ''; 

            if (!codeValidated) {
                // TENTATIVA DE VALIDA√á√ÉO DO C√ìDIGO
                const code = recoveryCodeInput.value;
                
                // SIMULA√á√ÉO: Usa '123456' como c√≥digo v√°lido
                if (code === '123456') { 
                    codeValidated = true;
                    
                    // Habilita campos de senha e troca bot√µes
                    newPasswordInput.disabled = false;
                    confirmPasswordInput.disabled = false;
                    validateButton.style.display = 'none';
                    resetButton.style.display = 'block';
                    recoveryCodeInput.disabled = true; 
                    
                    modalMessage.style.color = 'green';
                    modalMessage.textContent = 'C√≥digo validado! Digite sua nova senha.';
                    
                } else {
                    modalMessage.style.color = 'red';
                    modalMessage.textContent = 'C√≥digo inv√°lido. Tente novamente.';
                }
            } else {
                // TENTATIVA DE REDEFINI√á√ÉO DE SENHA
                const newPass = newPasswordInput.value;
                const confirmPass = confirmPasswordInput.value;

                if (newPass.length < 6) {
                     modalMessage.style.color = 'red';
                     modalMessage.textContent = 'A senha deve ter pelo menos 6 caracteres.';
                     return;
                }

                if (newPass !== confirmPass) {
                    modalMessage.style.color = 'red';
                    modalMessage.textContent = 'As senhas n√£o coincidem.';
                    return;
                }
                
                modalMessage.style.color = 'green';
                modalMessage.textContent = 'Senha redefinida com sucesso!';
                
                setTimeout(() => {
                    closeRecoveryModal();
                }, 2000);
            }
        });

        // Listener para o bot√£o Redefinir Senha
        resetButton.addEventListener('click', (e) => {
            recoveryForm.dispatchEvent(new Event('submit'));
        });
        
        // --- 6. INICIALIZA√á√ÉO ---
        updateCarousel();
    });
</script>

<script src="../javascript/auth.js"></script>
</body>
</html>


